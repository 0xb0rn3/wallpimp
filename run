#!/usr/bin/env bash
_x(){ printf "$1"; }
_e(){ eval "$1"; }
_d(){ echo "$1" | base64 -d; }

_c(){
    local _z=("$@")
    local _b=()
    for _a in "${_z[@]}"; do
        [[ "$_a" =~ ^[^:]+:(.+)$ ]] && _b+=("${BASH_REMATCH[1]}")
    done
    printf '%s\n' "${_b[@]}"
}

_f(){
    local _m="$1"
    local _n="$2"
    local _o="$3"
    local _p=()
    
    IFS=':' read -ra _q <<< "$_m"
    for _r in "${_q[@]}"; do
        [[ "$_r" =~ ^[^:]+$ ]] && _p+=("$_r")
    done
    
    printf '%s\n' "${_p[@]}" | while read -r _s; do
        _e "$_n '$_s' '$_o'"
    done
}

_g(){
    local _t=$(mktemp -d)
    local _u="/tmp/$(tr -dc 'a-zA-Z0-9' < /dev/urandom | fold -w 10 | head -n 1)"
    trap 'rm -rf "'"$_t"'"' EXIT
    
    local _v=(
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL2RoYXJteC93YWxscw==,bWFpbixNaW5pbWFsIGFuZCBhZXN0aGV0aWMgd2FsbHBhcGVycw==")"
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL0ZyZW56eUV4aXN0cy93YWxscGFwZXJz,bWFpbixOYXR1cmUgYW5kIGFic3RyYWN0IGFydCB3YWxscGFwZXJz")"
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL21pY2hhZWxTY29waWMvV2FsbHBhcGVycw==,bWFpbixTY2VuaWMgYW5kIGxhbmRzY2FwZSB3YWxscGFwZXJz")"
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL3J5YW40eWluL3dhbGxwYXBlcnM=,bWFpbixBbmltZSBhbmQgZGlnaXRhbCBhcnQgd2FsbHBhcGVycw==")"
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL3BvcnQxOXgvV2FsbHBhcGVycw==,bWFpbixNaW5pbWFsaXN0IGRlc2t0b3Agd2FsbHBhcGVycw==")"
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL0QzRXh0L2Flc3RoZXRpYy13YWxscGFwZXJz,bWFpbixBZXN0aGV0aWMgYW5kIGFydGlzdGljIHdhbGxwYXBlcnM=")"
        "$(_d "aHR0cHM6Ly9naXRodWIuY29tL21ha2Njci93YWxscGFwZXJz,bWFpbixNaXhlZCBjb2xsZWN0aW9uIG9mIGhpZ2gtcXVhbGl0eSB3YWxscGFwZXJz")"
    )
    
    local _w=0 _x=0 _y=0 _z=0
    
    _h(){ 
        local _k="$1"
        local _l=$(basename "$_k")
        local _m="${_t}/${_l}"
        
        _x "$(_d "XCRCTFVFXSBQcm9jZXNzaW5nIFtcJHtCT0xEfSR7X2x9XCRSRVNFVF1cbiIpIHwgdHIgLWQgJ1xuJw==")"
        
        if git clone --depth 1 --branch "$(_c "$_k")" "$(_c "$_k")" "$_m" &> "$_u"; then
            local _a=0 _b=0
            
            local _i=(
                "*.jpg" "*.jpeg" "*.png" "*.gif" "*.bmp" "*.tiff" "*.webp" "*.psd"
                "*.raw" "*.cr2" "*.nef" "*.dng"
                "*.avif" "*.heic" "*.svg" "*.jxr" "*.jp2"
                "*.JPG" "*.JPEG" "*.PNG" "*.GIF" "*.BMP"
            )
            
            _j(){ 
                local _y="$1"
                local _z="$2"
                
                local _w=$(file -b --mime-type "$_y")
                
                case "$_w" in 
                    image/*|*image*)
                        _w=$(echo "$_w" | cut -d';' -f1)
                        local _h=$(sha256sum "$_y" | cut -d' ' -f1)
                        local _n=$(basename "$_y")
                        local _p="${_z}/${_h}_${_n}"
                        
                        cp "$_y" "$_p"
                        return 0
                        ;;
                    *)
                        return 1
                        ;;
                esac
            }
            
            local _d_cmd=("find" "$_m" "-type" "f")
            for _p in "${_i[@]}"; do
                _d_cmd+=("-o" "-name" "$_p")
            done
            
            while IFS= read -r -d '' _e; do
                if _j "$_e" "$(_c "$_k" | cut -d',' -f3)"; then
                    ((_a++))
                else
                    ((_b++))
                fi
            done < <("${_d_cmd[@]}" -print0)
            
            ((_w++))
            ((_y+=_a))
            ((_z+=_b))
            return 0
        else
            ((_x++))
            return 1
        fi
    }
    
    for _k in "${_v[@]}"; do
        _h "$_k"
    done
}

_k(){
    _x "$(_d "XCRCT0xEfVxlWzM0bVxuCuKVoOKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlOKVoFxuCnwgICAgICBXYWxsUGltcCBWZXI6MC4zIFNUQUJMRSAgICAgICAgfAp8ICAgIFdhbGxwYXBlciBEb3dubG9hZCBBc3Npc3RhbnQgICAgfAp8ICAgICAgICBieSAweGIwcm4zIChCYXNoIFBvcnQpICAgICAgIHwKXeKVoOKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlOKVoFxuXCRSRVNFVF0iKQ==")"
    
    local _l="${HOME}/Pictures/Wallpapers"
    read -p "$(_d "V2hlcmUgd291bGQgeW91IGxpa2UgdG8gc2F2ZSB3YWxscGFwZXJzPyBbXSk=")" _m
    _m=${_m:-"$_l"}
    mkdir -p "$_m"
    
    _g "$_m"
    
    _x "$(_d "XG5cZVsxbV1cZVszNm3ilqDilpTilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilpDilqBcbgo=")"
    _x "$(_d "XGVbMzRtXSBTdWNjZXNzZnVsbHkgZG93bmxvYWRlZDogXGVbMzJtJHtfd31cZVswbVxuIg==")"
    _x "$(_d "XGVbMzRtXSBGYWlsZWQgZG93bmxvYWRzOiBcZVszMW0ke19sfVxlWzBtXG4i")"
    _x "$(_d "XGVbMzRtXSBUb3RhbCB3YWxscGFwZXJzIHByb2Nlc3NlZDogXGVbMzJtJHtfeX1cZVswbVxuIg==")"
    _x "$(_d "XGVbMzRtXSBEdXBsaWNhdGVzIHNraXBwZWQ6IFxlWzMzbSR7X3p9XGVbMG1cbiIp")"
    _x "$(_d "XGVbMzRtXSBXYWxscGFwZXJzIHNhdmVkIHRvOiBcZVszMm0ke19tfVxlWzBtXG4i")"
    _x "$(_d "XGVbMW1dXGVbMzRt4pag4paU4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4paQ4pag\xuXGVbMG0i")"
}

_k
